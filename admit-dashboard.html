<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Admin Dashboard ‚Äî EduBot GTU</title>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --gtu-blue: #003366;
      --gtu-blue-2:#0059b3;
      --bg:#f3f7ff;
      --card:#ffffff;
      --muted:#6b7280;
      --success:#16a34a;
      --danger:#dc2626;
      --glass: rgba(255,255,255,0.65);
      --shadow: 0 8px 30px rgba(2,6,23,0.08);
    }

    /* dark mode variables */
    :root.dark{
      --bg: #071025;
      --card: #061226;
      --muted: #94a3b8;
      --glass: rgba(255,255,255,0.03);
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:"Poppins",system-ui,Arial,sans-serif;
      background:var(--bg);
      color: #071522;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      transition: background .25s ease, color .25s ease;
    }

    /* layout */
    .app {
      display:flex;
      min-height:100vh;
      gap:20px;
    }

    /* SIDEBAR */
    .sidebar{
      width:260px;
      background:linear-gradient(180deg,var(--gtu-blue),var(--gtu-blue-2));
      color:white;
      padding:22px;
      border-radius:12px;
      box-shadow:var(--shadow);
      flex-shrink:0;
      display:flex;
      flex-direction:column;
      gap:18px;
      position:sticky;
      top:20px;
      height:calc(100vh - 40px);
    }
    .sidebar .brand{
      display:flex;
      align-items:center;
      gap:12px;
      font-weight:700;
      font-size:18px;
    }
    .sidebar .brand img{width:40px;border-radius:6px}
    .nav-group{margin-top:6px}
    .nav-item{
      display:flex;
      gap:10px;
      align-items:center;
      padding:10px 12px;
      border-radius:8px;
      cursor:pointer;
      color:rgba(255,255,255,0.95);
      text-decoration:none;
      transition:background .18s, transform .12s;
      font-weight:600;
    }
    .nav-item:hover{background:rgba(255,255,255,0.06); transform:translateY(-3px)}
    .nav-item.active{background:rgba(0,0,0,0.12);}

    .spacer{flex:1}

    /* topbar + content wrapper */
    .main{
      flex:1;
      padding:28px;
      display:flex;
      flex-direction:column;
      gap:18px;
    }

    .topbar{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
    }

    .topbar .title{
      display:flex;
      gap:12px;
      align-items:center;
    }
    .title h1{
      margin:0;font-size:20px;color:var(--gtu-blue);
    }
    .top-actions{display:flex;gap:10px;align-items:center}

    /* dark toggle */
    .toggle {
      display:inline-flex;align-items:center;gap:8px;background:var(--glass);padding:8px 12px;border-radius:999px;cursor:pointer;
      border:1px solid rgba(255,255,255,0.06);
    }
    .toggle input{display:none}

    /* Responsive compact sidebar button */
    .hamburger{
      display:none;
      background:var(--card);
      border-radius:8px;padding:8px;cursor:pointer;
      box-shadow:var(--shadow);
    }

    /* FORM CARD (floating card animation) */
    .form-card{
      background:var(--card);
      padding:18px;
      border-radius:12px;
      box-shadow:var(--shadow);
      transition:transform .25s ease, box-shadow .25s ease;
      width:100%;
      max-width:920px;
    }
    .form-card:hover{transform:translateY(-6px); box-shadow:0 20px 40px rgba(2,6,23,0.12)}

    .form-grid{
      display:grid;
      grid-template-columns:1fr 1fr;
      gap:12px;
    }
    @media(max-width:880px){ .form-grid{grid-template-columns:1fr} .sidebar{display:none} .hamburger{display:block} }

    label{display:block;font-weight:600;margin-bottom:6px}
    .input{
      width:100%;padding:10px;border-radius:8px;border:1px solid #d1d5db;background:transparent;font-size:14px;
      transition:box-shadow .18s, border-color .18s;
    }
    .input:focus{outline:none;border-color:var(--gtu-blue); box-shadow:0 6px 18px rgba(3,77,164,0.12)}

    /* glow effect */
    .input.glow:focus{box-shadow:0 10px 30px rgba(3,77,164,0.18)}

    .btn{
      display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:10px;border:0;background:linear-gradient(90deg,var(--gtu-blue),var(--gtu-blue-2));color:white;font-weight:700;cursor:pointer;
      transition:transform .15s, box-shadow .15s;
    }
    .btn:hover{transform:translateY(-3px); box-shadow:0 14px 30px rgba(0,85,179,0.18)}

    .btn.secondary{background:transparent;color:var(--gtu-blue);border:1px solid var(--gtu-blue)}

    /* success toast */
    .toast{
      position:fixed; right:28px; bottom:28px; background:#0b3; color:white; padding:12px 16px; border-radius:10px; box-shadow:0 10px 30px rgba(2,6,23,0.2); display:none; z-index:1200;
    }

    /* table */
    .card{
      background:var(--card); padding:12px; border-radius:12px; box-shadow:var(--shadow);
      overflow:auto;
    }
    table{width:100%; border-collapse:collapse; min-width:720px}
    th, td {padding:10px 12px; text-align:left; border-bottom:1px solid rgba(0,0,0,0.06)}
    th{background:transparent;color:var(--muted); font-weight:700; font-size:13px}
    tr:hover td{background: linear-gradient(90deg, rgba(3,77,164,0.03), transparent)}
    .small{font-size:13px;color:var(--muted)}

    .actions button{margin-right:8px;padding:6px 8px;border-radius:8px;border:0;cursor:pointer;font-weight:600}
    .actions .edit{background:#fde68a} .actions .delete{background:#fecaca}

    /* modal */
    .modal-backdrop{position:fixed; inset:0; display:none; align-items:center; justify-content:center; background:rgba(2,6,23,0.5); z-index:2000}
    .modal{width:100%;max-width:640px;background:var(--card); padding:18px;border-radius:12px; box-shadow:var(--shadow)}

    /* utilities */
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    .right{margin-left:auto}
    .muted{color:var(--muted);font-size:13px}
    .search{padding:8px 12px;border-radius:10px;border:1px solid #d1d5db; width:260px}

    /* footer small */
    .footer-sm{font-size:13px;color:var(--muted);margin-top:12px}

  </style>
</head>
<body>

  <div class="app">

    <!-- SIDEBAR -->
    <aside class="sidebar" id="sidebar">
      <div class="brand">
        <img src="assets/logo.png" alt="GTU logo">
        EduBot GTU
      </div>

      <div class="nav-group" id="navGroup">
        <a class="nav-item active" data-section="dashboard">üè† Dashboard</a>
        <a class="nav-item" data-section="add">‚ûï Add Material</a>
        <a class="nav-item" data-section="manage">üóÇ Manage Materials</a>
        <a class="nav-item" data-section="settings">‚öôÔ∏è Settings</a>
      </div>

      <div class="spacer"></div>

      <div style="font-size:13px;color:rgba(255,255,255,0.9)">Logged in as <strong>admin</strong></div>
      <div class="muted" style="font-size:12px">Pro tip: export `materials.json` to push changes to GitHub.</div>
    </aside>

    <!-- MAIN -->
    <main class="main">

      <!-- TOPBAR -->
      <div class="topbar">
        <div class="title">
          <div>
            <h1>Admin Dashboard</h1>
            <div class="muted">Manage GTU study materials ‚Ä¢ Add / Edit / Delete ‚Ä¢ Export JSON</div>
          </div>
        </div>

        <div class="top-actions">
          <input id="searchInput" class="search" placeholder="Search subject, unit, description">
          <div class="row">
            <label class="toggle" title="Toggle dark mode">
              <input id="darkToggle" type="checkbox">
              <span id="toggleLabel">üåô Dark</span>
            </label>

            <button class="btn secondary" id="importBtn" title="Import materials.json">üì• Import JSON</button>
            <button class="btn" id="exportBtn" title="Export materials.json">üì§ Export JSON</button>

            <button class="hamburger" id="hamb">‚ò∞</button>
          </div>
        </div>
      </div>

      <!-- SECTION: add -->
      <section id="section-add" style="display:block">

        <!-- FORM CARD -->
        <div class="form-card" role="region" aria-label="Add material form">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
            <div>
              <strong style="font-size:16px">‚ûï Add New Material</strong>
              <div class="muted" style="font-size:13px">Fill details and click Upload ‚Ä¢ Fields required</div>
            </div>

            <div class="row">
              <button class="btn" id="bulkAddBtn">‚ûï Bulk Add</button>
              <button class="btn secondary" id="clearBtn">üßπ Clear Form</button>
            </div>
          </div>

          <div class="form-grid">
            <div>
              <label>Subject Name <span class="muted">üìö</span></label>
              <input id="subject" class="input glow" placeholder="e.g., Analysis and Design of Algorithms" />
            </div>

            <div>
              <label>Material Type <span class="muted">üìé</span></label>
              <select id="type" class="input">
                <option value="Notes">Notes</option>
                <option value="PDF">PDF</option>
                <option value="Book">GTU Book</option>
                <option value="PYQ">Previous Year Paper</option>
                <option value="Playlist">Playlist</option>
                <option value="Other">Other</option>
              </select>
            </div>

            <div>
              <label>Unit / Chapter <span class="muted">üîñ</span></label>
              <input id="unit" class="input" placeholder="Unit 1, Unit 2 or Chapter name" />
            </div>

            <div>
              <label>Link (Google Drive / URL) <span class="muted">üîó</span></label>
              <input id="link" class="input" placeholder="https://drive.google.com/..." />
            </div>

            <div style="grid-column: 1 / -1">
              <label>Description <span class="muted">‚úçÔ∏è</span></label>
              <textarea id="description" class="input" rows="3" placeholder="Short description, semester, tags..."></textarea>
            </div>

          </div>

          <div style="display:flex;gap:10px;margin-top:12px">
            <button class="btn" id="uploadBtn">‚úÖ Upload Material</button>
            <button class="btn secondary" id="previewBtn">üëÅÔ∏è Preview</button>
            <div class="right muted">Last saved: <span id="lastSaved">Never</span></div>
          </div>
        </div>

      </section>

      <!-- SECTION: manage -->
      <section id="section-manage" style="display:block">
        <div class="card" style="margin-top:6px">
          <div style="display:flex;align-items:center;justify-content:space-between;margin-bottom:8px">
            <strong>üìÇ Material Library</strong>
            <div class="muted">Total items: <span id="totalCount">0</span></div>
          </div>

          <div style="overflow:auto">
            <table id="materialsTable" aria-describedby="materials">
              <thead>
                <tr>
                  <th>Subject</th>
                  <th>Type</th>
                  <th>Unit</th>
                  <th>Description</th>
                  <th>Link</th>
                  <th class="small">Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <div style="margin-top:12px;display:flex;gap:10px;align-items:center;">
            <button class="btn secondary" id="deleteAll">üóëÔ∏è Delete All</button>
            <div class="muted footer-sm">Tip: Use Export JSON to push updates to GitHub repo (materials.json)</div>
          </div>
        </div>
      </section>

      <!-- SECTION: settings -->
      <section id="section-settings" style="display:block">
        <div class="card" style="margin-top:6px">
          <strong>‚öôÔ∏è Settings</strong>
          <div style="margin-top:12px" class="muted">
            <p><strong>Dark Mode:</strong> Toggle the theme for admin console.</p>
            <p><strong>Import/Export:</strong> Import a `materials.json` downloaded from repo to update the dashboard locally; export will generate a `materials.json` to download.</p>
            <p><strong>Persistence:</strong> Changes are saved to your browser localStorage. To push to GitHub, export JSON and update the repo file manually.</p>
          </div>
        </div>
      </section>

      <div class="footer-sm">EduBot GTU ‚Äî Admin Console ‚Ä¢ Built for GTU Students</div>

    </main>
  </div>

  <!-- modal for edit -->
  <div class="modal-backdrop" id="modal">
    <div class="modal" role="dialog" aria-modal="true">
      <h3>Edit Material</h3>
      <div style="margin-top:8px">
        <label>Subject</label>
        <input id="editSubject" class="input" />
        <label>Type</label>
        <input id="editType" class="input" />
        <label>Unit</label>
        <input id="editUnit" class="input" />
        <label>Link</label>
        <input id="editLink" class="input" />
        <label>Description</label>
        <textarea id="editDesc" class="input" rows="3"></textarea>
      </div>

      <div style="display:flex;gap:8px;margin-top:12px;justify-content:flex-end">
        <button class="btn secondary" id="cancelEdit">Cancel</button>
        <button class="btn" id="saveEdit">Save Changes</button>
      </div>
    </div>
  </div>

  <div class="toast" id="toast">Saved</div>

<script>
/* =============================
   Data store (localStorage)
   ============================= */
const STORAGE_KEY = 'gtu_materials_v1';
const THEME_KEY = 'gtu_admin_theme_v1';

let materials = JSON.parse(localStorage.getItem(STORAGE_KEY) || '[]');

/* Helper: render table rows */
function renderTable(filter=''){
  const tbody = document.querySelector('#materialsTable tbody');
  tbody.innerHTML = '';
  const list = materials.filter(m => {
    if(!filter) return true;
    const s = (m.subject + ' ' + m.unit + ' ' + m.type + ' ' + m.description).toLowerCase();
    return s.includes(filter.toLowerCase());
  });
  list.forEach((m, idx) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td>${escapeHtml(m.subject)}</td>
      <td>${escapeHtml(m.type)}</td>
      <td>${escapeHtml(m.unit)}</td>
      <td>${escapeHtml(m.description)}</td>
      <td><a href="${escapeAttr(m.link)}" target="_blank" rel="noopener">Open</a></td>
      <td class="actions">
        <button class="edit" data-index="${idx}">‚úèÔ∏è Edit</button>
        <button class="delete" data-index="${idx}">üóëÔ∏è Delete</button>
      </td>
    `;
    tbody.appendChild(tr);
  });
  document.getElementById('totalCount').textContent = materials.length;
}

/* escape helpers */
function escapeHtml(s){ return (s||'').toString().replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;'); }
function escapeAttr(s){ return (s||'').toString().replaceAll('"','%22'); }

/* save to localStorage */
function saveStore(){
  localStorage.setItem(STORAGE_KEY, JSON.stringify(materials));
  document.getElementById('lastSaved').textContent = new Date().toLocaleString();
  showToast('Saved locally');
}

/* show toast */
function showToast(msg='Saved'){
  const t = document.getElementById('toast');
  t.textContent = msg; t.style.display='block';
  setTimeout(()=> t.style.display='none', 2500);
}

/* form reset */
function clearForm(){
  ['subject','type','unit','link','description'].forEach(id => document.getElementById(id).value = '');
}

/* add single material */
document.getElementById('uploadBtn').addEventListener('click', () => {
  const subject = document.getElementById('subject').value.trim();
  const type = document.getElementById('type').value.trim();
  const unit = document.getElementById('unit').value.trim();
  const link = document.getElementById('link').value.trim();
  const description = document.getElementById('description').value.trim();

  if(!subject || !link){
    alert('Please provide at least subject and link.');
    return;
  }

  materials.unshift({subject,type,unit,link,description,created: new Date().toISOString()});
  saveStore(); renderTable(); clearForm();
});

/* clear button */
document.getElementById('clearBtn').addEventListener('click', clearForm);

/* delete & edit events using event delegation */
document.querySelector('#materialsTable tbody').addEventListener('click', (e) => {
  const idx = e.target.dataset.index;
  if(e.target.classList.contains('delete')){
    if(confirm('Delete this material?')){
      materials.splice(idx,1); saveStore(); renderTable();
    }
  } else if(e.target.classList.contains('edit')){
    openEditModal(idx);
  }
});

/* open edit modal */
let currentEditIndex = null;
function openEditModal(idx){
  currentEditIndex = idx;
  const m = materials[idx];
  document.getElementById('editSubject').value = m.subject;
  document.getElementById('editType').value = m.type;
  document.getElementById('editUnit').value = m.unit;
  document.getElementById('editLink').value = m.link;
  document.getElementById('editDesc').value = m.description;
  document.getElementById('modal').style.display = 'flex';
}

/* save edit */
document.getElementById('saveEdit').addEventListener('click', () => {
  if(currentEditIndex===null) return;
  const m = materials[currentEditIndex];
  m.subject = document.getElementById('editSubject').value.trim();
  m.type = document.getElementById('editType').value.trim();
  m.unit = document.getElementById('editUnit').value.trim();
  m.link = document.getElementById('editLink').value.trim();
  m.description = document.getElementById('editDesc').value.trim();
  saveStore(); renderTable(); closeModal();
});

/* cancel edit */
document.getElementById('cancelEdit').addEventListener('click', closeModal);
document.getElementById('modal').addEventListener('click', (e) => { if(e.target.id==='modal') closeModal(); });
function closeModal(){ document.getElementById('modal').style.display='none'; currentEditIndex=null; }

/* delete all */
document.getElementById('deleteAll').addEventListener('click', () => {
  if(!confirm('Delete ALL materials? This cannot be undone locally.')) return;
  materials = []; saveStore(); renderTable();
});

/* search */
document.getElementById('searchInput').addEventListener('input', (e) => {
  renderTable(e.target.value);
});

/* export JSON (download materials.json) */
document.getElementById('exportBtn').addEventListener('click', () => {
  const dataStr = JSON.stringify(materials, null, 2);
  const blob = new Blob([dataStr], {type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'materials.json'; document.body.appendChild(a); a.click();
  a.remove(); URL.revokeObjectURL(url);
  showToast('materials.json downloaded');
});

/* import JSON file (load materials.json) */
document.getElementById('importBtn').addEventListener('click', () => {
  const input = document.createElement('input');
  input.type='file'; input.accept='application/json';
  input.onchange = (e) => {
    const file = e.target.files[0];
    if(!file) return;
    const reader = new FileReader();
    reader.onload = () => {
      try{
        const j = JSON.parse(reader.result);
        if(!Array.isArray(j)) throw new Error('Invalid format');
        materials = j;
        saveStore(); renderTable(); showToast('Imported materials.json');
      }catch(err){ alert('Invalid JSON file.'); }
    };
    reader.readAsText(file);
  };
  input.click();
});

/* bulk add demo (example using prompt) */
document.getElementById('bulkAddBtn').addEventListener('click', () => {
  const sample = [
    {subject:'Analysis and Design of Algorithms', type:'Notes', unit:'Unit 3', link:'https://drive.google.com/example1', description:'Greedy algorithms summary'},
    {subject:'Computer Networks', type:'PYQ', unit:'Unit 5', link:'https://drive.google.com/example2', description:'Important questions 2023-24'},
  {subject:'Python for Data Science', type:'Playlist', unit:'N/A', link:'https://youtube.com/example', description:'Top video playlist'}
  ];
  materials = sample.concat(materials);
  saveStore(); renderTable(); showToast('Bulk materials added');
});

/* preview button: open a quick modal-like window showing current form data */
document.getElementById('previewBtn').addEventListener('click', () => {
  const subject = document.getElementById('subject').value || '[subject]';
  const type = document.getElementById('type').value || '[type]';
  const unit = document.getElementById('unit').value || '[unit]';
  const link = document.getElementById('link').value || '[link]';
  const description = document.getElementById('description').value || '[description]';
  alert(`Preview\n\nSubject: ${subject}\nType: ${type}\nUnit: ${unit}\nLink: ${link}\nDescription: ${description}`);
});

/* sidebar navigation switching (show/hide sections) */
document.querySelectorAll('.nav-item').forEach(it => {
  it.addEventListener('click', () => {
    document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
    it.classList.add('active');
    const section = it.dataset.section;
    // simple switch: show add, manage, settings correspondingly
    document.getElementById('section-add').style.display = section==='add' || section==='dashboard' ? 'block' : 'none';
    document.getElementById('section-manage').style.display = section==='manage' || section==='dashboard' ? 'block' : 'none';
    document.getElementById('section-settings').style.display = section==='settings' ? 'block' : 'none';
  });
});

/* hamburger for small screens */
document.getElementById('hamb').addEventListener('click', () => {
  const sb = document.getElementById('sidebar');
  if(sb.style.display === 'none' || getComputedStyle(sb).display === 'none'){
    sb.style.display = 'flex';
  } else {
    sb.style.display = 'none';
  }
});

/* dark mode toggle */
const darkToggle = document.getElementById('darkToggle');
function applyTheme(isDark){
  if(isDark) document.documentElement.classList.add('dark');
  else document.documentElement.classList.remove('dark');
  localStorage.setItem(THEME_KEY, isDark ? 'dark':'light');
}
darkToggle.addEventListener('change', () => { applyTheme(darkToggle.checked); });
/* load theme preference */
const savedTheme = localStorage.getItem(THEME_KEY) || 'light';
applyTheme(savedTheme==='dark');
darkToggle.checked = savedTheme === 'dark';

/* keyboard shortcuts: Ctrl+S to export */
window.addEventListener('keydown', (e) => {
  if((e.ctrlKey||e.metaKey) && e.key.toLowerCase()==='s'){
    e.preventDefault(); document.getElementById('exportBtn').click();
  }
});

/* helper: initial render */
renderTable();

/* initial visibility: dashboard means show both add & manage; hide settings */
document.getElementById('section-settings').style.display = 'none';

/* small accessibility: focus outlines for keyboard */
document.addEventListener('keydown', (e) => {
  if(e.key==='Tab') document.body.classList.add('show-focus');
});

/* export convenience: auto-save every 30s (local only) */
setInterval(() => { saveStore(); }, 30000);

</script>
</body>
</html>